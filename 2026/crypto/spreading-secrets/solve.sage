from Crypto.Util.number import long_to_bytes

a = 4378187236568178488156374902954033554168817612809876836185687985356955098509507459200406211027348332345207938363733672019865513005277165462577884966531159
b = 5998166089683146776473147900393246465728273146407202321254637450343601143170006002385750343013383427197663710513197549189847700541599566914287390375415919
c = 4686793799228153029935979752698557491405526130735717565192889910432631294797555886472384740255952748527852713105925980690986384345817550367242929172758571
d = 4434206240071905077800829033789797199713643458206586525895301388157719638163994101476076768832337473337639479654350629169805328840025579672685071683035027
p = 12670098302188507742440574100120556372985016944156009521523684257469947870807586552014769435979834701674318132454810503226645543995288281801918123674138911
share = 6435837956013280115905597517488571345655611296436677708042037032302040770233786701092776352064370211838708484430835996068916818951183247574887417224511655
Fp = GF(p)
R.<x> = PolynomialRing(Fp)

current_coeff = x
secret_finding_polynomial = x
for i in range(9):
    current_coeff = a*current_coeff^3 + b*current_coeff^2 + c*current_coeff + d
    secret_finding_polynomial += current_coeff

secret_finding_polynomial -= share

answer = b''
while answer[:5] != b'lactf':
    root = secret_finding_polynomial.any_root()
    answer = long_to_bytes(int(root))
    print(f"Found potential root: {root}")
    # Factor out the root
    secret_finding_polynomial //= (x-root)

print(answer)
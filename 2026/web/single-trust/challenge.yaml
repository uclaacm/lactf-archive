name: single-trust
author: r2uwu2
description: |-
  I was researching zero trust proofs in cryptography and now I have zero trust in JWT libraries so might roll my own.

  Turns out, [Aplet123 was researching zero trust proofs (web/zero-trust)](https://platform.2023.lac.tf/challs#:~:text=zero-trust) a few years ago in LA CTF 2023.

  I trust aplet so I'll just use his library (with his backdoor patched out). 

  ```
  $: diff single-trust/index.js zero-trust/index.js
  47c47
  <         res.locals.user = JSON.parse(Buffer.concat([cipher.update(ct), cipher.final()]).toString("utf8"));
  ---
  >         res.locals.user = JSON.parse(cipher.update(ct).toString("utf8"));
  ```

  {{link}}

  Note: the flag is in `/flag.txt`

flag:
  file: flag.txt

provide:
  - ./single-trust.zip

containers:
  main:
    build: .
    ports:
      - 8080

expose:
  main:
    - target: 8080
      http: single-trust
